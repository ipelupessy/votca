/*
 *            Copyright 2009-2020 The VOTCA Development Team
 *                       (http://www.votca.org)
 *
 *      Licensed under the Apache License, Version 2.0 (the "License")
 *
 * You may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *              http://www.apache.org/licenses/LICENSe-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

#include <votca/xtp/eigen.h>
#include <votca/xtp/gauss_legendre_quadrature_constants.h>

using namespace std;

namespace votca {
namespace xtp {

const Eigen::VectorXd& Gauss_Legendre_Quadrature_Constants::getPoints(
    Index order) {
  if (!this->_filled_Points) {
    this->FillPoints();
    _filled_Points = true;
  }
  if (_map_points.count(order) == 0)
    throw invalid_argument("Order " + std::to_string(order) +
                           " not in range {8,10,12,...,20}.");
  return _map_points.at(order);
}

const Eigen::VectorXd& Gauss_Legendre_Quadrature_Constants::getAdaptedWeights(
    Index order) {
  if (!this->_filled_AdaptedWeights) {
    this->FillAdaptedWeights();
    _filled_AdaptedWeights = true;
  }
  if (_map_AdaptedWeights.count(order) == 0)
    throw invalid_argument("Order " + std::to_string(order) +
                           " not in range {8,10,12,...,20}.");
  return _map_AdaptedWeights.at(order);
}

void Gauss_Legendre_Quadrature_Constants::FillPoints() {


Eigen::VectorXd points_12(12);
  points_12 << -0.9815606342467192506906,
-0.9041172563704748566785,
-0.769902674194304687037,
-0.5873179542866174472967,
-0.3678314989981801937527,
-0.1252334085114689154724,
0.1252334085114689154724,
0.3678314989981801937527,
0.5873179542866174472967,
0.7699026741943046870369,
0.9041172563704748566785,
0.9815606342467192506906;
  _map_points[12] = points_12;


  Eigen::VectorXd points_40(40);
  points_40 << -0.9982377097105592003496,
-0.9907262386994570064531,
-0.9772599499837742626634,
-0.9579168192137916558045,
-0.9328128082786765333609,
-0.9020988069688742967283,
-0.8659595032122595038208,
-0.8246122308333116631963,
-0.778305651426519387695,
-0.727318255189927103281,
-0.6719566846141795483794,
-0.6125538896679802379526,
-0.5494671250951282020759,
-0.4830758016861787129086,
-0.4137792043716050015249,
-0.3419940908257584730075,
-0.2681521850072536811412,
-0.1926975807013710997155,
-0.1160840706752552084835,
-0.0387724175060508219332,
0.0387724175060508219332,
0.1160840706752552084835,
0.1926975807013710997155,
0.2681521850072536811412,
0.3419940908257584730075,
0.4137792043716050015249,
0.4830758016861787129086,
0.5494671250951282020759,
0.6125538896679802379526,
0.6719566846141795483794,
0.727318255189927103281,
0.778305651426519387695,
0.8246122308333116631963,
0.8659595032122595038208,
0.9020988069688742967283,
0.9328128082786765333609,
0.9579168192137916558045,
0.9772599499837742626634,
0.9907262386994570064531,
0.9982377097105592003496;
  _map_points[40] = points_40;


  Eigen::VectorXd points_60(60);
  points_60 << -0.9982377097105592003496,
-0.9907262386994570064531,
-0.9772599499837742626634,
-0.9579168192137916558045,
-0.9328128082786765333609,
-0.9020988069688742967283,
-0.8659595032122595038208,
-0.8246122308333116631963,
-0.778305651426519387695,
-0.727318255189927103281,
-0.6719566846141795483794,
-0.6125538896679802379526,
-0.5494671250951282020759,
-0.4830758016861787129086,
-0.4137792043716050015249,
-0.3419940908257584730075,
-0.2681521850072536811412,
-0.1926975807013710997155,
-0.1160840706752552084835,
-0.0387724175060508219332,
0.0387724175060508219332,
0.1160840706752552084835,
0.1926975807013710997155,
0.2681521850072536811412,
0.3419940908257584730075,
0.4137792043716050015249,
0.4830758016861787129086,
0.5494671250951282020759,
0.6125538896679802379526,
0.6719566846141795483794,
0.727318255189927103281,
0.778305651426519387695,
0.8246122308333116631963,
0.8659595032122595038208,
0.9020988069688742967283,
0.9328128082786765333609,
0.9579168192137916558045,
0.9772599499837742626634,
0.9907262386994570064531,
0.9982377097105592003496;
_map_points[60] = points_60;


Eigen::VectorXd points_200(200);
  points_200 << -0.999928071285,
-0.999621031281,
-0.999068721873,
-0.998271155949,
-0.997228514283,
-0.995941049261,
-0.994409075766,
-0.992632969417,
-0.990613166031,
-0.988350161361,
-0.985844510922,
-0.983096829826,
-0.980107792621,
-0.976878133117,
-0.973408644203,
-0.969700177652,
-0.965753643911,
-0.961570011872,
-0.957150308639,
-0.952495619273,
-0.947607086528,
-0.942485910566,
-0.937133348666,
-0.931550714912,
-0.925739379874,
-0.919700770269,
-0.913436368611,
-0.906947712849,
-0.900236395986,
-0.89330406569,
-0.88615242389,
-0.878783226356,
-0.871198282271,
-0.863399453783,
-0.855388655553,
-0.847167854277,
-0.838739068214,
-0.830104366679,
-0.821265869544,
-0.812225746713,
-0.802986217591,
-0.793549550536,
-0.783918062308,
-0.774094117495,
-0.764080127933,
-0.753878552117,
-0.743491894596,
-0.732922705356,
-0.722173579196,
-0.711247155091,
-0.700146115544,
-0.688873185927,
-0.677431133812,
-0.66582276829,
-0.654050939285,
-0.642118536853,
-0.630028490468,
-0.617783768311,
-0.605387376533,
-0.592842358524,
-0.58015179416,
-0.567318799051,
-0.554346523775,
-0.541238153102,
-0.527996905217,
-0.514626030925,
-0.501128812856,
-0.487508564658,
-0.473768630183,
-0.459912382668,
-0.445943223905,
-0.431864583407,
-0.417679917562,
-0.403392708793,
-0.389006464695,
-0.374524717177,
-0.359951021594,
-0.345288955877,
-0.33054211965,
-0.31571413335,
-0.300808637337,
-0.285829291,
-0.270779771857,
-0.255663774657,
-0.240485010466,
-0.225247205763,
-0.20995410152,
-0.194609452286,
-0.179217025265,
-0.163780599388,
-0.148303964393,
-0.132790919884,
-0.117245274409,
-0.101670844515,
-0.0860714538191,
-0.0704509320652,
-0.054813114185,
-0.0391618393564,
-0.0235009500615,
-0.00783429114231,
0.00783429114231,
0.0235009500615,
0.0391618393564,
0.054813114185,
0.0704509320652,
0.0860714538191,
0.101670844515,
0.117245274409,
0.132790919884,
0.148303964393,
0.163780599388,
0.179217025265,
0.194609452286,
0.20995410152,
0.225247205763,
0.240485010466,
0.255663774657,
0.270779771857,
0.285829291,
0.300808637337,
0.31571413335,
0.33054211965,
0.345288955877,
0.359951021594,
0.374524717177,
0.389006464695,
0.403392708793,
0.417679917562,
0.431864583407,
0.445943223905,
0.459912382668,
0.473768630183,
0.487508564658,
0.501128812856,
0.514626030925,
0.527996905217,
0.541238153102,
0.554346523775,
0.567318799051,
0.58015179416,
0.592842358524,
0.605387376533,
0.617783768311,
0.630028490468,
0.642118536853,
0.654050939285,
0.66582276829,
0.677431133812,
0.688873185927,
0.700146115544,
0.711247155091,
0.722173579196,
0.732922705356,
0.743491894596,
0.753878552117,
0.764080127933,
0.774094117495,
0.783918062308,
0.793549550536,
0.802986217591,
0.812225746713,
0.821265869544,
0.830104366679,
0.838739068214,
0.847167854277,
0.855388655553,
0.863399453783,
0.871198282271,
0.878783226356,
0.88615242389,
0.89330406569,
0.900236395986,
0.906947712849,
0.913436368611,
0.919700770269,
0.925739379874,
0.931550714912,
0.937133348666,
0.942485910566,
0.947607086528,
0.952495619273,
0.957150308639,
0.961570011872,
0.965753643911,
0.969700177652,
0.973408644203,
0.976878133117,
0.980107792621,
0.983096829826,
0.985844510922,
0.988350161361,
0.990613166031,
0.992632969417,
0.994409075766,
0.995941049261,
0.997228514283,
0.998271155949,
0.999068721873,
0.999621031281,
0.999928071285;
_map_points[200] = points_200;
}

void Gauss_Legendre_Quadrature_Constants::FillAdaptedWeights() {

    Eigen::VectorXd AdaptedWeights_12(12);
  AdaptedWeights_12 << 0.0471753363865118271946,
0.1069393259953184309603,
0.1600783285433462263347,
0.2031674267230659217491,
0.233492536538354808761,
0.2491470458134027850006,
0.2491470458134027850006,
0.233492536538354808761,
0.203167426723065921749,
0.160078328543346226335,
0.1069393259953184309603,
0.0471753363865118271946;

  _map_AdaptedWeights[12] = AdaptedWeights_12;

    Eigen::VectorXd AdaptedWeights_40(40);
  AdaptedWeights_40 << 0.0045212770985331912585,
0.0104982845311528136147,
0.0164210583819078887129,
0.0222458491941669572615,
0.0279370069800234010985,
0.0334601952825478473927,
0.03878216797447201764,
0.04387090818567327199168,
0.0486958076350722320614,
0.053227846983936824355,
0.057439769099391551367,
0.0613062424929289391665,
0.0648040134566010380746,
0.067912045815233903826,
0.0706116473912867796955,
0.0728865823958040590605,
0.0747231690579682642002,
0.0761103619006262423716,
0.077039818164247965588,
0.0775059479784248112637,
0.07750594797842481126372,
0.077039818164247965588,
0.0761103619006262423716,
0.0747231690579682642002,
0.0728865823958040590605,
0.0706116473912867796955,
0.067912045815233903826,
0.064804013456601038075,
0.0613062424929289391665,
0.057439769099391551367,
0.053227846983936824355,
0.0486958076350722320614,
0.0438709081856732719917,
0.03878216797447201764,
0.0334601952825478473927,
0.027937006980023401098,
0.0222458491941669572615,
0.0164210583819078887129,
0.0104982845311528136147,
0.0045212770985331912585;
  _map_AdaptedWeights[40] = AdaptedWeights_40;

 Eigen::VectorXd AdaptedWeights_60(60);
AdaptedWeights_60 << 0.0045212770985331912585,
0.0104982845311528136147,
0.0164210583819078887129,
0.0222458491941669572615,
0.0279370069800234010985,
0.0334601952825478473927,
0.03878216797447201764,
0.04387090818567327199168,
0.0486958076350722320614,
0.053227846983936824355,
0.057439769099391551367,
0.0613062424929289391665,
0.0648040134566010380746,
0.067912045815233903826,
0.0706116473912867796955,
0.0728865823958040590605,
0.0747231690579682642002,
0.0761103619006262423716,
0.077039818164247965588,
0.0775059479784248112637,
0.07750594797842481126372,
0.077039818164247965588,
0.0761103619006262423716,
0.0747231690579682642002,
0.0728865823958040590605,
0.0706116473912867796955,
0.067912045815233903826,
0.064804013456601038075,
0.0613062424929289391665,
0.057439769099391551367,
0.053227846983936824355,
0.0486958076350722320614,
0.0438709081856732719917,
0.03878216797447201764,
0.0334601952825478473927,
0.027937006980023401098,
0.0222458491941669572615,
0.0164210583819078887129,
0.0104982845311528136147,
0.0045212770985331912585;
_map_AdaptedWeights[60] = AdaptedWeights_60;

 Eigen::VectorXd AdaptedWeights_200(200);
AdaptedWeights_200 << 0.000184590097466,
0.000429646630453,
0.000674960634478,
0.000920140459342,
0.00116510071476,
0.00140977682745,
0.00165410755231,
0.00189803250494,
0.00214149163944,
0.00238442511201,
0.00262677324452,
0.00286847651947,
0.0031094755861,
0.00334971127104,
0.00358912459081,
0.00382765676534,
0.00406524923178,
0.00430184365851,
0.00453738195936,
0.00477180630764,
0.00500505915034,
0.00523708322216,
0.00546782155955,
0.00569721751469,
0.00592521476935,
0.00615175734873,
0.00637678963518,
0.00660025638186,
0.00682210272629,
0.0070422742038,
0.00726071676096,
0.00747737676877,
0.00769220103587,
0.00790513682161,
0.00811613184895,
0.00832513431733,
0.00853209291539,
0.00873695683353,
0.00893967577642,
0.00914019997535,
0.00933848020041,
0.00953446777262,
0.00972811457584,
0.00991937306862,
0.0101081962958,
0.0102945379003,
0.010478352134,
0.0106595938693,
0.0108382186105,
0.0110141825041,
0.0111874423497,
0.0113579556112,
0.0115256804265,
0.0116905756182,
0.0118526007034,
0.012011715904,
0.0121678821564,
0.0123210611208,
0.0124712151907,
0.0126183075025,
0.0127623019442,
0.0129031631642,
0.0130408565803,
0.0131753483878,
0.0133066055683,
0.0134345958974,
0.0135592879526,
0.0136806511212,
0.013798655608,
0.0139132724421,
0.0140244734843,
0.0141322314342,
0.0142365198365,
0.0143373130878,
0.0144345864428,
0.0145283160202,
0.0146184788089,
0.0147050526734,
0.0147880163593,
0.0148673494985,
0.0149430326141,
0.0150150471257,
0.0150833753532,
0.0151480005215,
0.0152089067648,
0.0152660791304,
0.0153195035819,
0.0153691670035,
0.0154150572023,
0.0154571629122,
0.0154954737959,
0.0155299804478,
0.0155606743964,
0.015587548106,
0.0156105949792,
0.0156298093576,
0.0156451865242,
0.0156567227035,
0.0156644150636,
0.0156682617158,
0.0156682617158,
0.0156644150636,
0.0156567227035,
0.0156451865242,
0.0156298093576,
0.0156105949792,
0.015587548106,
0.0155606743964,
0.0155299804478,
0.0154954737959,
0.0154571629122,
0.0154150572023,
0.0153691670035,
0.0153195035819,
0.0152660791304,
0.0152089067648,
0.0151480005215,
0.0150833753532,
0.0150150471257,
0.0149430326141,
0.0148673494985,
0.0147880163593,
0.0147050526734,
0.0146184788089,
0.0145283160202,
0.0144345864428,
0.0143373130878,
0.0142365198365,
0.0141322314342,
0.0140244734843,
0.0139132724421,
0.013798655608,
0.0136806511212,
0.0135592879526,
0.0134345958974,
0.0133066055683,
0.0131753483878,
0.0130408565803,
0.0129031631642,
0.0127623019442,
0.0126183075025,
0.0124712151907,
0.0123210611208,
0.0121678821564,
0.012011715904,
0.0118526007034,
0.0116905756182,
0.0115256804265,
0.0113579556112,
0.0111874423497,
0.0110141825041,
0.0108382186105,
0.0106595938693,
0.010478352134,
0.0102945379003,
0.0101081962958,
0.00991937306862,
0.00972811457584,
0.00953446777262,
0.00933848020041,
0.00914019997535,
0.00893967577642,
0.00873695683353,
0.00853209291539,
0.00832513431733,
0.00811613184895,
0.00790513682161,
0.00769220103587,
0.00747737676877,
0.00726071676096,
0.0070422742038,
0.00682210272629,
0.00660025638186,
0.00637678963518,
0.00615175734873,
0.00592521476935,
0.00569721751469,
0.00546782155955,
0.00523708322216,
0.00500505915034,
0.00477180630764,
0.00453738195936,
0.00430184365851,
0.00406524923178,
0.00382765676534,
0.00358912459081,
0.00334971127104,
0.0031094755861,
0.00286847651947,
0.00262677324452,
0.00238442511201,
0.00214149163944,
0.00189803250494,
0.00165410755231,
0.00140977682745,
0.00116510071476,
0.000920140459342,
0.000674960634478,
0.000429646630453,
0.000184590097466;
_map_AdaptedWeights[200] = AdaptedWeights_200;
}
}
}
