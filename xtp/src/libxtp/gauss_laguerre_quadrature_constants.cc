/*
 *            Copyright 2009-2020 The VOTCA Development Team
 *                       (http://www.votca.org)
 *
 *      Licensed under the Apache License, Version 2.0 (the "License")
 *
 * You may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *              http://www.apache.org/licenses/LICENSe-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

#include <votca/xtp/eigen.h>
#include <votca/xtp/gauss_laguerre_quadrature_constants.h>

using namespace std;

/*******************
 * Public Methods *
 *******************/
namespace votca {
namespace xtp {

const Eigen::VectorXd& Gauss_Laguerre_Quadrature_Constants::getPoints(
    Index order) {
  if (!this->_filled_Points) {
    this->FillPoints();
    _filled_Points = true;
  }
  if (_map_points.count(order) == 0) {
    throw invalid_argument("Order " + std::to_string(order) +
                           " not in range {8,10,12,...,20}!");
  }
  return _map_points.at(order);
}

const Eigen::VectorXd& Gauss_Laguerre_Quadrature_Constants::getAdaptedWeights(
    Index order) {
  if (!this->_filled_AdaptedWeights) {
    this->FillAdaptedWeights();
    _filled_AdaptedWeights = true;
  }
  if (_map_AdaptedWeights.count(order) == 0) {
    throw invalid_argument("Order " + std::to_string(order) +
                           " not in range {8,10,12,...,20}!");
  }
  return _map_AdaptedWeights.at(order);
}

/*******************
 * Private Methods *
 *******************/

void Gauss_Laguerre_Quadrature_Constants::FillPoints() {
  Eigen::VectorXd points_8(8);
  points_8 << 0.17027963230510099978886185660829724468251824708548,
      0.9037017767993799121860202235550898922166525972985,
      2.2510866298661306893071183669686351538381871358948,
      4.2667001702876587936494218269006396344821222793532,
      7.0459054023934656972793254821193584980087387492524,
      10.758516010180995224059956788032034147832602219141,
      15.740678641278004578028761158402835874146032041614,
      22.863131736889264105700534297413109554793146730361;
  _map_points[8] = points_8;
  Eigen::VectorXd points_10(10);
  points_10 << 0.1377934705404924308307725056527111881079916807458,
      0.7294545495031704981603731216760787810760727333122,
      1.8083429017403160482329200757506088332830602823715,
      3.4014336978548995144825322214083906792731566142035,
      5.5524961400638036324175584868687628579740642873178,
      8.330152746764496700238767197274522182709438972031,
      11.843785837900065564918538919141613985802816909465,
      16.279257831378102099532653935833622335255995603033,
      21.996585811980761951277090195594493976806732340002,
      29.920697012273891559908793340799195179710670577518;
  _map_points[10] = points_10;
  Eigen::VectorXd points_12(12);
  points_12 << 0.11572211735802067526719642824049422371981805287062,
      0.6117574845151306653916300530416698801066213555077,
      1.512610269776418786781737926866697246973609916394,
      2.8337513377435072286274717765721434586744749567016,
      4.5992276394183484846057292248505333063864850146524,
      6.8445254531151773477543304184938407896643044488694,
      9.6213168424568670439123823492309910941421457731566,
      13.006054993306347720346052429401001984505838945536,
      17.116855187462255728184052800759193917914019230472,
      22.151090379397005669921895083663788010407725298709,
      28.48796725098400031256860723252153419851162040233,
      37.099121044466920336638914276358111888993336604802;
  _map_points[12] = points_12;
  Eigen::VectorXd points_14(14);
  points_14 << 0.0997475070325975745736829452514337328496035798394,
      0.5268576488519028964045834515021405172634500388511,
      1.3006291212514964817084202211569857435644440547503,
      2.4308010787308446361699975103839831795758034729374,
      3.93210282229321888213134366777639017436772314625,
      5.825536218301708419338999838984992693945922492875,
      8.1402401415651450300597804605200400135811494427105,
      10.916499507366018840813051090408562918776029134103,
      14.210805011161288683105978082509492366054109733828,
      18.104892220218098412554627208297871875299155685169,
      22.723381628269624823228088698478093397573388953516,
      28.272981723248205695415892321792259432913212010101,
      35.149443660592426582864312136374578367282950253361,
      44.366081711117423041631242366563175586953058001708;
  _map_points[14] = points_14;
  Eigen::VectorXd points_16(16);
  points_16 << 0.0876494104789278403601980973401034621419572269307,
      0.462696328915080831880838260664253790647713617829,
      1.141057774831226856877945018105178437344393273812,
      2.129283645098380616326159070658178825103674723855,
      3.437086633893206645235107016751850636368112142398,
      5.0780186145497679129230583081419290650410566835825,
      7.0703385350482341303959894708013377973907115507906,
      9.4383143363919387839472467291128233157596833315712,
      12.214223368866158736939124608824202825826006388601,
      15.441527368781617076764774162213510172456158693868,
      19.18015685675313485466314094973963152074358424594,
      23.515905693991908531823187275156254224431439633643,
      28.578729742882140367520613709877699560720238612648,
      34.583398702286625814527687177752583364021196976611,
      41.940452647688332635472233025186596374902502248119,
      51.7011603395433183643426971196738666271015706498;
  _map_points[16] = points_16;
  Eigen::VectorXd points_18(18);
  points_18 << 0.0781691666697054712986747615334420233702209795519,
      0.4124900852591292910391015365358187181177146313242,
      1.0165201796235396891909368618668855701206401569414,
      1.894888509969760914267278319541264842564557062806,
      3.054353113202659751152411307188873720946276545317,
      4.5042055388898928263379557145489659831509941873015,
      6.2567250739491114527420911632631325424397973997244,
      8.3278251566056300217047026156366702569736425802806,
      10.73799004775760933521790333966296316427852438555,
      13.513656207555089819086381210822127397981969779753,
      16.689306281930105937818398416274447581466477919728,
      20.310767626267742856131376455327358444583306013385,
      24.44068135928370276564422579804482604635135712019,
      29.168208662579616131298067780459902617589068898445,
      34.627927065660172145401242943827329353360610031535,
      41.041816772808758139294861428387138227755853533312,
      48.833922716086522748658609329001988025490585699449,
      59.090546435901250703715781018076865483458403075406;
  _map_points[18] = points_18;
  Eigen::VectorXd points_20(20);
  points_20 << 0.0705398896919887533666890045842150958693606298353,
      0.3721268180016114437942413887611466366740282101562,
      0.916582102483273564667716277074183187205604198043,
      1.7073065310283438806876896674130507061879399482153,
      2.7491992553094321296450304604948133842756169174058,
      4.0489253138508869223749533691333321965066524470376,
      5.6151749708616165141045398856518923479177568766444,
      7.4590174536710633097688602183718175953844771201739,
      9.594392869581096772473672734282798378150637894214,
      12.038802546964316309623409298865515868227553873675,
      14.814293442630739978512679710047975674250757105644,
      17.948895520519376017365790992612509648678004429199,
      21.47878824028501097573517036959466921620975569711,
      25.451702793186905503518677484641541838163511223646,
      29.932554631700612006713656135165823251660560350598,
      35.013434240479000006284935906688139581765928732597,
      40.8330570567285710620295677078075526717076597492,
      47.619994047346502139941627152851121113143970342575,
      55.810795750063898890750773444497235628385311248334,
      66.524416525615753818640318791460665979634913005697;
  _map_points[20] = points_20;
  Eigen::VectorXd points_30(30);
  points_30 << 0.3183869683782846720241,
0.74604898384339593642,
1.32843338066108587611,
2.06808006865262729335,
2.967095281229613127532,
4.02786680237875792966,
5.2532139862492682096,
6.646460975984512160435,
8.21150016445807249016,
9.95286216299950838971,
11.87579916669630787089,
13.98638697594673273484,
16.2916514852049941496,
18.79972708449388597521,
21.5200570694376313645,
24.46365015938707445985,
27.64341327561422548296,
31.07459005416318559591,
34.77534930681949456802,
38.76759168133671294143,
43.07808342036488467368,
47.74009782499716729754,
52.79587800759381106873,
58.30049638945455743091,
64.32824152435303841276,
70.98395415552802548934,
78.42512633640139197336,
86.9111128078765662465,
96.93790723137099686941,
109.7809372681241893096;
  _map_points[30] = points_30;
}

void Gauss_Laguerre_Quadrature_Constants::FillAdaptedWeights() {
  Eigen::VectorXd AdaptedWeights_8(8);
  AdaptedWeights_8 << 0.4377234104929113732325975801238703103376631775236,
      1.033869347665597642499265855827602461954335024897,
      1.6697097656587757491539220177008427856051063662388,
      2.3769247017585994809591690994750058720662557571753,
      3.2085409133479262842483918457600300070144929506379,
      4.268575510825132198584121630659636092804766871837,
      5.81808336867192192828814196198241067161659726355,
      8.906226215292211406501042881028511446149064456402;
  _map_AdaptedWeights[8] = AdaptedWeights_8;
  Eigen::VectorXd AdaptedWeights_10(10);
  AdaptedWeights_10 << 0.354009738606996308762226891442067608352461375232,
      0.8319023010435807381098296581278495772769414887138,
      1.3302885617493281787527921943939936989529079083161,
      1.8630639031111309897639887354824669365659029551084,
      2.4502555580830101660726937316575225674840723086896,
      3.122764155135182496150818263314554723390177279479,
      3.934152695561521098655812459248230777449846058056,
      4.99241487219302310201148565243315445132156715098,
      6.57220248513080297518766871037611234659532162923,
      9.7846958403746306947700866387185981389150975238;
  _map_AdaptedWeights[10] = AdaptedWeights_10;
  Eigen::VectorXd AdaptedWeights_12(12);
  AdaptedWeights_12 << 0.29720963604441079779198122036754357695062747309614,
      0.6964629804305972306780669558553119367200522247323,
      1.1077813946157521533394673801418981284103516456771,
      1.5384642390428291247940386335053805911722249486239,
      1.9983276062742427651969640965367302175914220369978,
      2.5007457691008668747508706633043160797088609808069,
      3.065321518282386236204603418051038424900531165525,
      3.723289110782771599995609779712930189226527287525,
      4.529814029981735062093311912367881036129552807779,
      5.5972584618353210926905239085094747371049317491765,
      7.2129954609258770081711351665202483272292177775714,
      10.543837461910081111715846770154439584665010094888;
  _map_AdaptedWeights[12] = AdaptedWeights_12;
  Eigen::VectorXd AdaptedWeights_14(14);
  AdaptedWeights_14 << 0.25613115473690945367155604137236094757882153053717,
      0.5991704774951183385157662720719434606317389384044,
      0.9499715024749579869125484270936094947507661292047,
      1.3128078114661639384270884248489802423178192160109,
      1.6932659907519653529745410676462360050266873059999,
      2.098409084271843687773502577270101983723504094644,
      2.5376326549353938448820099657512096366218759469362,
      3.0241599177032399386467951716218970800189870315433,
      3.577804355719859916426068792226390777216598510176,
      4.230565034906432048949948938499946279885083169143,
      5.0394133684635116188297693664760942153547229583944,
      6.120947928329725523704405649801959608037466565982,
      7.7742953670060321174893698342712637506928074474584,
      11.21683421670331968972355415696472732866015480776;
  _map_AdaptedWeights[14] = AdaptedWeights_14;
  Eigen::VectorXd AdaptedWeights_16(16);
  AdaptedWeights_16 << 0.2250363148642472519066007573814144458690185247157,
      0.5258360527623424536145694105195410860858136585704,
      0.831961391687087087665388515060005798365531503267,
      1.1460992409637517046479569302568902959453778405277,
      1.471751316966808588743042045866684543762434226604,
      1.813134687381348164887396108630316034513537481787,
      2.1755175196946074520626708322288638779797078925836,
      2.565762750165029209248616884561986932692202919775,
      2.993215086371375165178025151565561897712713600071,
      3.471234483102090290873868627597548190602231270141,
      4.020044086444668866478284115357455952539428504624,
      4.672516607732854267365709256517417593833911905772,
      5.48742065798615247120752800022638302859933708972,
      6.58536123328921366083470226903840093817534637811,
      8.27635798436423448649507548525324886996687288917,
      11.82427755165843478668777351092777039548497478358;
  _map_AdaptedWeights[16] = AdaptedWeights_16;
  Eigen::VectorXd AdaptedWeights_18(18);
  AdaptedWeights_18 << 0.2006779892089060424567117353858677921357410065508,
      0.4685526868918793123451038404723618531476174159314,
      0.7402656826535084821328848952165180073326729046531,
      1.0175917173039668575733601963884569464681833491062,
      1.3028787020654185274613294165010989084158853049221,
      1.598862139757241971464163626319250748097864369331,
      1.908813906969691449405383185790548603253747095167,
      2.236777877856928862808745488037440092537055724348,
      2.587924166792750465265463240542766432247187473213,
      2.969102377726253026889997545139828219911420194409,
      3.389748873854004693214943133356206203447866755699,
      3.863462276042960583502177219572994264901461070218,
      4.4109368969663167872945574616798809600665149029142,
      5.0659315146113905979769671798325064724279803521,
      5.888946263673389544438677676632267647722417256986,
      7.00435926919015216807565159336225208655434075251,
      8.73234485076647154208563069167393633193242434362,
      12.379906492173747450634250720326202919731298778298;
  _map_AdaptedWeights[18] = AdaptedWeights_18;
  Eigen::VectorXd AdaptedWeights_20(20);
  AdaptedWeights_20 << 0.1810800624189892554516754059131106442274690763912,
      0.4225567678785639745203441725664581975475829520687,
      0.6669095467018481503734821149925159278667309548724,
      0.91535237278307367267060468477186806700815510543294,
      1.169539707195545973801478222395774760596840666293,
      1.4313549859282059863684499489151433158764096086852,
      1.7029811379850227240253326163320672029093050496994,
      1.9870158907927472141092183927512902068826472595247,
      2.2866357812534307854622285468149565116091533479661,
      2.605834727553833332694989509540333237056796189593,
      2.949783734213950866002354168272859510783865111907,
      3.325395782009319552369519374217511185662934568037,
      3.742255470589810921117072932653778117460980980766,
      4.214236710251880419868080637824787464513838141909,
      4.7625184614902092969529219783909637106473444797488,
      5.42172604424557430380308297989981779213794759508,
      6.254012356932421292895184903007075421492954607332,
      7.38731438905443455194030019196464791168876917979,
      9.1513287309874796079434824255295052861521913541,
      12.89338864593999667102628712874852788017020483556;
  _map_AdaptedWeights[20] = AdaptedWeights_20;
  Eigen::VectorXd AdaptedWeights_30(30);
  AdaptedWeights_30 << 0.35195230419888486359,
0.504466611110333030292,
0.660673414488229949446,
0.81896410465481654484,
0.979462323254120195696,
1.142549493040125454648,
1.30869787043091439669,
1.478443689377299257569,
1.65238841189068953995,
1.83120926413891122682,
2.015675285857255245505,
2.20666869855111275548,
2.40521274426136427703,
2.61250810836316979967,
2.829981169922424749506,
3.05934895677787997176,
3.30270823036978493839,
3.56266026563947421473,
3.84248985964119451768,
4.14642927331943259873,
4.48005997854156061288,
4.8509474729026168453,
5.26969029053275916954,
5.7517507509580553315,
6.32087574308470493019,
7.0160769195177682633,
7.9076663101057761622,
9.1409088084699455711,
11.0915048418123412591,
15.3006860809361691006;
  _map_AdaptedWeights[30] = AdaptedWeights_30;
}
}  // namespace xtp
}  // namespace votca
